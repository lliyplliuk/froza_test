# Тестовое задание уровня Middle
### Текущее состояние
На текущий момент на страницу проверки цен попадают предложения, которые сверяются с текущей ценой, 
и попадают в блокировку(устанавливается флаг блокировки, текущая цена не меняется, 
предлагаемая цена устанавливается в соответствующий столбец) при значительном снижении цены.

### Сценарий появления
1. поставщик присылает прайс с корректными ценами - цены записываются в таблицу Price_MSC
2. поставщик присылает файл с некорректными ценами, значительно выше исходных - цены записываются в таблицу Price_MSC
3. поставщик присылает корректный файл с ценами из пункта 1 (или близкие к ним) - цена блокируется на запись в таблице Price_MSC

### Изменения
Необходимо изменить условия таким образом, чтобы цена сравнивалась не только с текущей, но и с предыдущей.

### Техническая информация
* Предыдущая цена - price_prev
* Текущая цена - price
* Следующая/предлагаемая цена - price_next
* Флаг need_chek используется дл построения отчетов о необходимости проверки заблокированных цен
* Для запуска используется компонент [symfony messenger](https://symfony.com/doc/current/messenger.html)


## Полезные команды
### Запуск докера
```bash
docker compose up -d
```

### Применение миграций
```bash
docker compose exec php bin/console doctrine:migration:migrate
```

### Варианты запуска команды:
* Парсинг нормальных цен
```bash
docker compose exec php bin/console test:pricer
```

* Парсинг с увеличением цен
```bash
docker compose exec php bin/console test:pricer --big=1
``` 

* Очистка таблицы цен
```bash
docker compose exec php bin/console test:pricer --clear=1
``` 
